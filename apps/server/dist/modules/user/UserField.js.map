{"version":3,"file":"UserField.js","names":["userTypeField","key","type","UserType","resolve","obj","args","context","UserLoader","load","userEdgeField","edgeField","connection","UserConnection","name","edgeName","userConnectionField","me","connectionArgs","_","user","_id","sponsoring","GraphQLString","isValid","Types","ObjectId","UserModel","findOne","username"],"sources":["../../../src/modules/user/UserField.ts"],"sourcesContent":["import { GraphQLString } from 'graphql';\nimport { Types } from 'mongoose';\n\nimport { connectionArgs } from 'graphql-relay';\n\nimport { edgeField } from '../graphql/edgeField';\n\nimport * as UserLoader from './UserLoader';\nimport { UserType, UserConnection } from './UserType';\n\nimport { UserModel } from './UserModel';\n\nexport const userTypeField = (key = 'user') => ({\n  [key]: {\n    type: UserType,\n    resolve: async (obj: any, args: any, context: any) => UserLoader.load(context, obj[key]),\n  },\n});\n\nexport const userEdgeField = edgeField({\n  connection: UserConnection,\n  load: UserLoader.load,\n  name: 'User',\n  edgeName: 'userEdge',\n});\n\nexport const userConnectionField = () => ({\n  me: {\n    type: UserType,\n    args: {\n      ...connectionArgs,\n    },\n    resolve: (_: any, args: any, context: any) => {\n      return UserLoader.load(context, context.user?._id);\n    },\n  },\n  sponsoring: {\n    type: UserType,\n    args: {\n      _id: {\n        type: GraphQLString,\n      },\n    },\n    resolve: async (_: any, args: any, context: any) => {\n      const isValid = Types.ObjectId.isValid(args._id);\n\n      if (isValid) {\n        return UserLoader.load(context, args._id);\n      }\n\n      const user = await UserModel.findOne({ username: args._id }, { _id: 1 });\n\n      if (!user) return null;\n\n      return UserLoader.load(context, user._id);\n    },\n  },\n});\n"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AAEA;;AAEA;;AACA;;AAEA;;;;;;;;;;;;;;;;AAEO,MAAMA,aAAa,GAAG,CAACC,GAAG,GAAG,MAAP,MAAmB;EAC9C,CAACA,GAAD,GAAO;IACLC,IAAI,EAAEC,kBADD;IAELC,OAAO;MAAA,6BAAE,WAAOC,GAAP,EAAiBC,IAAjB,EAA4BC,OAA5B;QAAA,OAA6CC,UAAU,CAACC,IAAX,CAAgBF,OAAhB,EAAyBF,GAAG,CAACJ,GAAD,CAA5B,CAA7C;MAAA,CAAF;;MAAA;QAAA;MAAA;IAAA;EAFF;AADuC,CAAnB,CAAtB;;;AAOA,MAAMS,aAAa,GAAG,IAAAC,oBAAA,EAAU;EACrCC,UAAU,EAAEC,wBADyB;EAErCJ,IAAI,EAAED,UAAU,CAACC,IAFoB;EAGrCK,IAAI,EAAE,MAH+B;EAIrCC,QAAQ,EAAE;AAJ2B,CAAV,CAAtB;;;AAOA,MAAMC,mBAAmB,GAAG,OAAO;EACxCC,EAAE,EAAE;IACFf,IAAI,EAAEC,kBADJ;IAEFG,IAAI,oBACCY,4BADD,CAFF;IAKFd,OAAO,EAAE,CAACe,CAAD,EAASb,IAAT,EAAoBC,OAApB,KAAqC;MAAA;;MAC5C,OAAOC,UAAU,CAACC,IAAX,CAAgBF,OAAhB,mBAAyBA,OAAO,CAACa,IAAjC,kDAAyB,cAAcC,GAAvC,CAAP;IACD;EAPC,CADoC;EAUxCC,UAAU,EAAE;IACVpB,IAAI,EAAEC,kBADI;IAEVG,IAAI,EAAE;MACJe,GAAG,EAAE;QACHnB,IAAI,EAAEqB;MADH;IADD,CAFI;IAOVnB,OAAO;MAAA,8BAAE,WAAOe,CAAP,EAAeb,IAAf,EAA0BC,OAA1B,EAA2C;QAClD,MAAMiB,OAAO,GAAGC,eAAA,CAAMC,QAAN,CAAeF,OAAf,CAAuBlB,IAAI,CAACe,GAA5B,CAAhB;;QAEA,IAAIG,OAAJ,EAAa;UACX,OAAOhB,UAAU,CAACC,IAAX,CAAgBF,OAAhB,EAAyBD,IAAI,CAACe,GAA9B,CAAP;QACD;;QAED,MAAMD,IAAI,SAASO,oBAAA,CAAUC,OAAV,CAAkB;UAAEC,QAAQ,EAAEvB,IAAI,CAACe;QAAjB,CAAlB,EAA0C;UAAEA,GAAG,EAAE;QAAP,CAA1C,CAAnB;QAEA,IAAI,CAACD,IAAL,EAAW,OAAO,IAAP;QAEX,OAAOZ,UAAU,CAACC,IAAX,CAAgBF,OAAhB,EAAyBa,IAAI,CAACC,GAA9B,CAAP;MACD,CAZM;;MAAA;QAAA;MAAA;IAAA;EAPG;AAV4B,CAAP,CAA5B"}